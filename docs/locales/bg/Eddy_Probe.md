# Вихров ток Индуктивна сонда

Този документ описва как да използвате индуктивна сонда [вихрови токове](https://en.wikipedia.org/wiki/Eddy_current) в Klipper.

Понастоящем сондата за вихрови токове не може да се използва за Z-насочване. Сензорът може да се използва само за Z-сондиране.

Започнете, като декларирате [probe_eddy_current config section](Config_Reference.md#probe_eddy_current) във файла printer.cfg. Препоръчително е да зададете `z_offset` на 0,5 mm. Обикновено сензорът се нуждае от `x_offset` и `y_offset`. Ако тези стойности не са известни, те трябва да се оценят по време на първоначалното калибриране.

Първата стъпка при калибрирането е да се определи подходящият DRIVE_CURRENT за сензора. Включете принтера в изходно положение и насочете главата на инструмента така, че сензорът да е близо до центъра на леглото и да е на около 20 мм над него. След това издайте командата `LDC_CALIBRATE_DRIVE_CURRENT CHIP=<config_name>`. Например, ако разделът на конфигурацията е наречен `[probe_eddy_current my_eddy_probe]`, тогава трябва да се изпълни `LDC_CALIBRATE_DRIVE_CURRENT CHIP=my_eddy_probe`. Тази команда трябва да приключи за няколко секунди. След като завърши, издайте командата `SAVE_CONFIG`, за да запазите резултатите в printer.cfg, и рестартирайте.

Втората стъпка при калибрирането е да се съпоставят показанията на сензора със съответните височини Z. Включете принтера в изходно положение и настройте главата на инструмента така, че дюзата да е близо до центъра на леглото. След това изпълнете командата `PROBE_EDDY_CURRENT_CALIBRATE CHIP=my_eddy_probe`. След като инструментът се стартира, следвайте стъпките, описани в ["the paper test"](Bed_Level.md#the-paper-test), за да определите действителното разстояние между дюзата и леглото на даденото място. След приключването на тези стъпки може да се приеме позицията. След това инструментът ще премести главата на инструмента, така че сензорът да се намира над точката, където е била дюзата, и ще извърши поредица от движения, за да съпостави сензора с Z позициите. Това ще отнеме няколко минути. След като инструментът завърши, издайте командата `SAVE_CONFIG`, за да запазите резултатите в printer.cfg, и рестартирайте.

След първоначалното калибриране е добре да проверите дали стойностите на `x_offset` и `y_offset` са точни. Следвайте стъпките за [калибриране на отместванията x и y на сондата](Probe_Calibrate.md#calibrating-probe-x-and-y-offsets). Ако `x_offset` или `y_offset` са променени, не забравяйте да изпълните командата `PROBE_EDDY_CURRENT_CALIBRATE` (както е описано по-горе) след извършване на промяната.

След като калибрирането е завършено, можете да използвате всички стандартни инструменти на Klipper, които използват Z-сонда.

Имайте предвид, че сензорите за вихрови токове (и индуктивните сонди като цяло) са податливи на "термичен дрейф". Това означава, че промените в температурата могат да доведат до промени в отчетената височина Z. Промените в температурата на повърхността на леглото или в температурата на хардуера на сензора могат да изкривят резултатите. Важно е калибрирането и сондирането да се извършват само когато температурата на принтера е стабилна.

## Калибриране на термичния дрейф

Както при всички индуктивни сонди, сондите за вихрови токове са подложени на значителен термичен дрейф. Ако вихровата сонда има температурен сензор на намотката, е възможно да се конфигурира `[temperature_probe]` за отчитане на температурата на намотката и да се активира софтуерна компенсация на дрейфа. За да се свърже температурна сонда с вихровотокова сонда, разделът `[temperature_probe]` трябва да има общо име с раздела `[probe_eddy_current]`. Например:

```
[probe_eddy_current my_probe]
# eddy probe configuration...

[temperature_probe my_probe]
# temperature probe configuration...
```

Вижте [configuration reference](Config_Reference.md#temperature_probe) за повече подробности относно конфигурирането на `temperature_probe`. Препоръчително е да конфигурирате опциите `calibration_position`, `calibration_extruder_temp`, `extruder_heating_z` и `calibration_bed_temp`, тъй като това ще автоматизира някои от стъпките, описани по-долу.

Производителите на вихрови сонди могат да предложат стандартна калибрация на дрейфа, която може да се добави ръчно към опцията `drift_calibration` в раздела `[probe_eddy_current]`. Ако това не е така или ако стандартното калибриране не работи добре във вашата система, модулът `temperature_probe` предлага процедура за ръчно калибриране чрез gcode командата `TEMPERATURE_PROBE_CALIBRATE`.

Преди извършване на калибрирането потребителят трябва да има представа каква е максималната постижима температура на намотката на температурната сонда. Тази температура трябва да се използва за задаване на параметъра `TARGET` на командата `TEMPERATURE_PROBE_CALIBRATE`. Целта е да се калибрира във възможно най-широк температурен диапазон, поради което е желателно да се започне със студен принтер и да се завърши с намотка при максималната температура, която може да достигне.

След като се конфигурира `[температурна сонда]`, могат да се предприемат следните стъпки за извършване на калибриране на температурния дрейф:

- Сондата трябва да се калибрира, като се използва `PROBE_EDDY_CURRENT_CALIBRATE`, когато се конфигурира и свърже `[temperature_probe]`. По този начин се улавя температурата по време на калибрирането, което е необходимо за извършване на компенсация на температурния дрейф.
- Уверете се, че дюзата е свободна от замърсявания и нишки.
- Преди калибрирането леглото, дюзата и намотката на сондата трябва да са студени.
- Следващите стъпки са необходими, ако опциите `calibration_position`, `calibration_extruder_temp` и `extruder_heating_z` в `[temperature_probe]` не са конфигурирани:
   - Преместете инструмента в центъра на леглото. Z трябва да е над 30 мм над леглото.
   - Загрейте екструдера до температура над максималната безопасна температура на леглото. 150-170С трябва да са достатъчни за повечето конфигурации. Целта на загряването на екструдера е да се избегне разширяването на дюзата по време на калибрирането.
   - Когато температурата на екструдера се успокои, преместете оста Z надолу до около 1 mm над леглото.
- Започнете калибриране на дрейфа. Ако името на сондата е `my_probe` и максималната температура на сондата, която можем да постигнем, е 80C, подходящата gcode команда е `TEMPERATURE_PROBE_CALIBRATE PROBE=my_probe TARGET=80`. Ако е конфигуриран, инструментът ще се придвижи до координатите X,Y, зададени от `calibration_position`, и стойността Z, зададена от `extruder_heating_z`. След нагряване на екструдера до зададената температура инструментът ще се придвижи до стойността Z, зададена от `calibration_position`.
- Процедурата ще поиска ръчна сонда. Извършете ръчната сонда с теста на хартията и `АКСЕПТ`. Процедурата за калибриране ще направи първия набор от проби със сондата, след което ще паркира сондата в позиция за нагряване.
- Ако параметърът `calibration_bed_temp` не е конфигуриран, включете отоплението на леглото до максималната безопасна температура. В противен случай тази стъпка ще бъде извършена автоматично.
- По подразбиране процедурата за калибриране изисква ръчна сонда на всеки 2С между пробите до достигане на `Целевата стойност`. Температурната разлика между пробите може да се персонализира чрез задаване на параметъра `STEP` в `TEMPERATURE_PROBE_CALIBRATE`. Трябва да се внимава, когато се задава персонализирана стойност на `STEP`, тъй като твърде висока стойност може да изисква твърде малко проби, което да доведе до лошо калибриране.
- Следните допълнителни gcode команди са достъпни по време на калибрирането на дрейфа:
   - `TEMPERATURE_PROBE_NEXT` може да се използва за форсиране на нова проба, преди да е достигната делтата на стъпката.
   - `TEMPERATURE_PROBE_COMPLETE` може да се използва за завършване на калибрирането преди достигане на `TARGET`.
   - `ABORT` може да се използва за прекратяване на калибрирането и изхвърляне на резултатите.
- След приключване на калибрирането използвайте `SAVE_CONFIG`, за да съхраните калибрирането на дрейфа.

Както може да се заключи, процесът на калибриране, описан по-горе, е по-труден и отнема повече време, отколкото повечето други процедури. Той може да изисква практика и няколко опита за постигане на оптимално калибриране.
